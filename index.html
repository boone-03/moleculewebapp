<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Updated Title -->
    <title>Drug Candidate Analyzer (Cited Demo)</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load FontAwesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* Custom Loader */
        .loader {
            border-top-color: #3498db;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-slate-100 font-sans flex items-center justify-center min-h-screen p-4">

    <!-- Main Application Card -->
    <div class="bg-white w-full max-w-2xl p-8 md:p-10 rounded-xl shadow-lg">
        
        <!-- Header -->
        <div class="flex items-center space-x-4 mb-6">
            <div class="flex-shrink-0 bg-blue-600 text-white w-12 h-12 rounded-lg flex items-center justify-center">
                <i class="fa-solid fa-flask-vial text-2xl"></i>
            </div>
            <div>
                <h1 class="text-2xl font-bold text-gray-900">Drug Candidate Analyzer</h1>
                <p class="text-gray-600">Demo of a multi-profile analysis suite.</p>
            </div>
        </div>

        <!-- Input Section -->
        <div class="mb-6">
            <label for="smiles-input" class="block text-sm font-medium text-gray-700 mb-2">Enter SMILES String:</label>
            <input type="text" id="smiles-input" class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., CC(=O)Oc1ccccc1C(=O)O">
            
            <!-- Example Buttons -->
            <div class="mt-4 flex flex-wrap gap-2">
                <button class="example-btn text-sm bg-gray-100 text-gray-700 px-3 py-1 rounded-full hover:bg-gray-200 transition" data-smiles="CC(=O)Oc1ccccc1C(=O)O">Aspirin</button>
                <button class="example-btn text-sm bg-gray-100 text-gray-700 px-3 py-1 rounded-full hover:bg-gray-200 transition" data-smiles="CC1(C(N2C(S1)C(C2=O)NC(=O)COC3=CC=CC=C3)C(=O)O)C">Penicillin V</button>
                <button class="example-btn text-sm bg-gray-100 text-gray-700 px-3 py-1 rounded-full hover:bg-gray-200 transition" data-smiles="CN(C)CCC(C1=CC=CC=C1)C2=CC=CC=N2">Doxylamine</button>
            </div>
        </div>

        <!-- Action Button & Loader -->
        <div class="mb-6 flex flex-col items-center">
            <button id="predict-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-blue-700 transition duration-300 ease-in-out">
                Analyze Candidate
            </button>
            <div id="loader" class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-10 w-10 mt-4" style="display: none;"></div>
            <p id="error-message" class="text-red-600 mt-4" style="display: none;">No data found for this SMILES string in the demo database.</p>
        </div>

        <!-- Results Section (Hidden by default) -->
        <div id="results-container" class="border-t border-gray-200 pt-6" style="display: none;">
            
            <!-- Overall Molecule Name -->
            <div class="flex items-center justify-between pb-3 border-b border-gray-200">
                <span class="text-gray-600 font-medium">Molecule (Source)</span>
                <!-- Name field will now include the CID -->
                <span id="result-name" class="font-bold text-gray-900 text-lg"></span>
            </div>

            <!-- Subsection 1: Solubility Report -->
            <h2 class="text-lg font-semibold text-gray-900 mt-6 mb-3">Solubility Report</h2>
            
            <div class="space-y-2">
                <div class="flex items-center justify-between py-2 border-b border-gray-100">
                    <span class="text-gray-600">Predicted Solubility</span>
                    <span id="result-solubility" class="px-3 py-1 rounded-full text-sm font-medium"></span>
                </div>
                <div class="flex items-center justify-between py-2 border-b border-gray-100">
                    <span class="text-gray-600">Optimization Score</span>
                    <span id="result-score" class="font-semibold text-blue-600"></span>
                </div>
                <div class="flex items-center justify-between py-2">
                    <span class="text-gray-600">Suggested Tweak</span>
                    <span id="result-tweak" class="font-semibold text-gray-900"></span>
                </div>
            </div>

            <!-- Subsection 2: ADMET Profile -->
            <h2 class="text-lg font-semibold text-gray-900 mt-6 mb-3">ADMET Profile</h2>

            <div class="space-y-2">
                <div class="flex items-center justify-between py-2 border-b border-gray-100">
                    <span class="text-gray-600">Blood-Brain Barrier (BBB)</span>
                    <span id="result-bbb" class="px-3 py-1 rounded-full text-sm font-medium"></span>
                </div>
                <div class="flex items-center justify-between py-2 border-b border-gray-100">
                    <span class="text-gray-600">Metabolism</span>
                    <span id="result-metabolism" class="font-semibold text-gray-900"></span>
                </div>
                <div class="flex items-center justify-between py-2">
                    <span class="text-gray-600">Toxicity</span>
                    <span id="result-toxicity" class="px-3 py-1 rounded-full text-sm font-medium"></span>
                </div>
            </div>

        </div>

    </div>

    <script>
        // --- Mock "AI Model" Database ---
        // This data is now based on real-world data from PubChem
        const mockModelData = {
            // Aspirin (CID: 2244)
            "CC(=O)Oc1ccccc1C(=O)O": {
                name: "Aspirin (PubChem CID: 2244)",
                // Solubility Report (Source: PubChem, ~3.4 mg/mL @ 20Â°C)
                solubility: "Moderate", // "Sparingly soluble"
                score: "B-", // Inferred
                tweak: "Formulate as salt (e.g., Lysine)", // Inferred
                // ADMET Profile (Source: PubChem / known pharmacology)
                bbb: "High", // Known to cross BBB
                metabolism: "Rapid (Ester hydrolysis)", // Well-known
                toxicity: "Low Risk (at therapeutic doses)" // Known
            },
            // Penicillin V (CID: 5904)
            "CC1(C(N2C(S1)C(C2=O)NC(=O)COC3=CC=CC=C3)C(=O)O)C": {
                name: "Penicillin V (PubChem CID: 5904)",
                // Solubility Report (Source: PubChem, ~1.2 mg/mL)
                solubility: "Low", // "Sparingly soluble"
                score: "C+", // Inferred
                tweak: "Formulate as salt (e.g., Potassium)", // This is why it's sold as Penicillin V-K
                // ADMET Profile (Source: PubChem / known pharmacology)
                bbb: "Low", // Poor penetration
                metabolism: "Excreted unchanged (~60%)", // Known
                toxicity: "Low Risk (allergy risk)" // Known
            },
            // Doxylamine (as Succinate Salt) (PubChem CID: 5282253)
            // The SMILES is for the parent compound (Doxylamine, CID: 3170)
            "CN(C)CCC(C1=CC=CC=C1)C2=CC=CC=N2": {
                name: "Doxylamine (as Succinate, CID: 5282253)",
                // Solubility Report (Source: PubChem, "Freely soluble" as salt)
                solubility: "High", // Salt form is 1g/1mL
                score: "A", // Inferred
                tweak: "None (Optimal as succinate salt)", // Inferred
                // ADMET Profile (Source: PubChem / known pharmacology)
                bbb: "High (Causes drowsiness)", // Known
                metabolism: "Hepatic (Liver)", // Known
                toxicity: "Low Risk (at therapeutic doses)" // Known
            }
        };

        // --- Helper function to set pill colors ---
        function setPill(element, value) {
            element.textContent = value;
            // Clear all previous color classes
            element.classList.remove('bg-green-100', 'text-green-800', 'bg-yellow-100', 'text-yellow-800', 'bg-red-100', 'text-red-800', 'bg-gray-100', 'text-gray-800');
            
            const lowerCaseValue = value.toLowerCase();

            if (lowerCaseValue.includes('high')) {
                element.classList.add('bg-green-100', 'text-green-800');
            } else if (lowerCaseValue.includes('moderate')) {
                element.classList.add('bg-yellow-100', 'text-yellow-800');
            } else if (lowerCaseValue.includes('low risk')) {
                element.classList.add('bg-green-100', 'text-green-800');
            } else if (lowerCaseValue.includes('low')) {
                element.classList.add('bg-yellow-100', 'text-yellow-800');
            } else if (lowerCaseValue.includes('high risk')) {
                element.classList.add('bg-red-100', 'text-red-800');
            } else {
                 element.classList.add('bg-gray-100', 'text-gray-800');
            }
        }

        // --- Get DOM Elements ---
        const smilesInput = document.getElementById('smiles-input');
        const predictBtn = document.getElementById('predict-btn');
        const loader = document.getElementById('loader');
        const resultsContainer = document.getElementById('results-container');
        const errorMessage = document.getElementById('error-message');
        const exampleBtns = document.querySelectorAll('.example-btn');

        // Result fields
        const resultName = document.getElementById('result-name');
        // Solubility fields
        const resultSolubility = document.getElementById('result-solubility');
        const resultScore = document.getElementById('result-score');
        const resultTweak = document.getElementById('result-tweak');
        // ADMET fields
        const resultBBB = document.getElementById('result-bbb');
        const resultMetabolism = document.getElementById('result-metabolism');
        const resultToxicity = document.getElementById('result-toxicity');


        // --- Event Listeners ---

        // Function to handle prediction
        function runPrediction() {
            const smiles = smilesInput.value.trim();

            // 1. Reset UI
            resultsContainer.style.display = 'none';
            errorMessage.style.display = 'none';
            loader.style.display = 'block';
            predictBtn.disabled = true;

            // 2. Simulate AI processing time
            setTimeout(() => {
                // 3. Find the molecule in our "database"
                const prediction = mockModelData[smiles];

                // 4. Stop loader
                loader.style.display = 'none';
                predictBtn.disabled = false;

                // 5. Display results or error
                if (prediction) {
                    // We found a match! Display the "coherent values".
                    
                    // Set molecule name (now includes CID)
                    resultName.textContent = prediction.name;

                    // Set Solubility Report
                    setPill(resultSolubility, prediction.solubility);
                    resultScore.textContent = prediction.score;
                    resultTweak.textContent = prediction.tweak;
                    
                    // Set ADMET Profile
                    setPill(resultBBB, prediction.bbb);
                    resultMetabolism.textContent = prediction.metabolism;
                    setPill(resultToxicity, prediction.toxicity);

                    resultsContainer.style.display = 'block';
                } else {
                    // No match found in our simple demo
                    errorMessage.style.display = 'block';
                }
            }, 1500); // 1.5 second simulated delay
        }

        // 1. Predict Button Click
        predictBtn.addEventListener('click', runPrediction);

        // 2. Example Buttons Click
        exampleBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                smilesInput.value = btn.getAttribute('data-smiles');
                runPrediction(); // Automatically run prediction on example click
            });
        });

    </script>
</body>
</html>
